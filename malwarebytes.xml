<?xml version="1.0" encoding="UTF-8"?>
<packages>

<!--
  NOTES
  1) Online/Uninstaller version is different from the .exe versions so we only check for presence
-->

<package
  id="malwarebytes"
  name="Malwarebytes Anti-Malware"
  revision="%version%-3"
  reboot="false"
  priority="10">

  <variable name="version" value="1.60.1.1000" />
  <variable name="fileversion" value="1.60.1.1000" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES%\Malwarebytes&apos; Anti-Malware"      architecture="x86" />
  <variable name="PKG_DESTINATION" value="%PROGRAMFILES(x86)%\Malwarebytes&apos; Anti-Malware" architecture="x64" />
  <variable name="DESKTOP" value="%ALLUSERSPROFILE%\Desktop" os="windows xp" />
  <variable name="DESKTOP" value="%PUBLIC%\Desktop"          os="windows 7" />

  <check type='logical' condition='and'>
    <check type='logical' condition='or'>
      <!-- version 1.5xx -->
      <check type="uninstall" condition="exists" path="Malwarebytes' Anti-Malware version %version%" />
      <check type="uninstall" condition="versiongreaterorequal" path="Malwarebytes' Anti-Malware" value='%version%' />
      <!-- version 1.6xx -->
      <check type="uninstall" condition="exists" path="Malwarebytes Anti-Malware version %version%" />
      <check type="uninstall" condition="versiongreaterorequal" path="Malwarebytes Anti-Malware" value='%version%' />
    </check>
    <check type="file" condition="exists" path="%PKG_DESTINATION%\mbam.exe" />
    <check type="file" condition="exists" path="%PKG_DESTINATION%\mbamgui.exe" />
  </check>

  <install cmd='"%SOFTWARE%\MalwareBytes\mbam-setup-%version%.exe" /verysilent /norestart /sp-' />
  <install cmd='%COMSPEC% /c del /q "%DESKTOP%\Malwarebyte*.lnk"'><exit code='any' /></install>

  <upgrade   include='install' />
  <downgrade include='install' />

  <remove cmd='"%PKG_DESTINATION%\unins000.exe" /verysilent' />
</package>

</packages>
