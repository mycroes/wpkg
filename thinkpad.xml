<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) Please check the EasyEject uninstall check when upgrading to version > 2.39 as that version has a stupid space at the end
-->

<packages>

<package
  id="tp_airbag"
  name="ThinkPad HDD AirBag"
  revision="%version%-0"
  priority="10"
  reboot="false">

  <variable name="file" value="6isa03ww.exe" />
  <variable name="version" value="1.71" />

  <check type="uninstall" condition="versiongreaterorequal" path="ThinkVantage Active Protection System" value="%version%" />

  <install cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"'>
    <exit code="3010" reboot="postponed" />
  </install>
  <upgrade cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <downgrade cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <remove  cmd='msiexec %MSI% /X{46A84694-59EC-48F0-964C-7E76E9F8A2ED}"' />
</package>

<package
  id="tp_ezeject"
  name="ThinkPad EasyEject"
  revision="%version%-0"
  priority="10"
  reboot="false">

  <variable name="file" value="7zu205ww.exe" />
  <variable name="version" value="2.39" />
  <variable name="tempdir" value="%SYSTEMDRIVE%\SWTOOLS\DRIVERS\EZEJECT" />

  <!-- v2.39 writes as space at the end of the name in uninstall -->
  <check type="uninstall" condition="versiongreaterorequal" path="ThinkPad EasyEject Utility " value="%version%" />

  <install   cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"' />
  <install   cmd='%COMSPEC% /c copy /y "%SOFTWARE%\ThinkPad\easyeject_setup.ins" "%tempdir%\setup.ins"' />
  <install   cmd='%tempdir%\setup.exe /s /sms /f1%tempdir%\setup.ins' />

  <upgrade   cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"' />
  <upgrade   cmd='%COMSPEC% /c copy /y "%SOFTWARE%\ThinkPad\easyeject_setup.ins" "%tempdir%\setup.ins"' />
  <upgrade   cmd='%tempdir%\setup.exe /s /sms /f1%tempdir%\setup.ins' />

  <downgrade cmd='"%SOFTWARE%\ThinkPad\%file%" /VERYSILENT /norestart"' />
  <downgrade cmd='%COMSPEC% /c copy /y "%SOFTWARE%\ThinkPad\easyeject_setup.ins" "%tempdir%\setup.ins"' />
  <downgrade cmd='%tempdir%\setup.exe /s /sms /f1%tempdir%\setup.ins' />

  <remove    cmd='RunDll32 "%PROGRAMFILES%\COMMON~1\INSTAL~1\engine\6\INTEL3~1\Ctor.dll,LaunchSetup" "%PROGRAMFILES%\InstallShield Installation Information\{1297C681-92D7-40EF-93BF-03F66EC5105C}\setup.exe" -l0x9 -AddRemove -s' />
  <remove    cmd='%COMSPEC% /c RD /Q /S "%tempdir%"'>
    <exit code="1" />
  </remove>

</package>

</packages>
