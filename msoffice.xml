<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) Upgrades do not work as running setup.exe when it's already installed WILL result in a prompt
  2) 2010 is the first to come in 32/64 bit versions. I need the CLSID id for the 32bit version verified.
-->

<packages>

<package
  id="office2010plus"
  name="MS Office Pro Plus 2010"
  revision="1"
  reboot="false"
  priority="10">

  <check type="uninstall" condition="exists" path="Microsoft Office Professional Plus 2010" />

  <install cmd='%COMSPEC% /c IF "%PROCESSOR_ARCHITECTURE%" == "x86"   "%SOFTWARE%\MS Office Pro Plus 2010\setup.exe"'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='%COMSPEC% /c IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" "%SOFTWARE%\MS Office Pro Plus 2010-x64\setup.exe"'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </install>
  <remove  cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "x86"   msiexec %MSI% /x{91140000-0011-0000-0000-0000000FF1CE}'>
    <exit code="3010" />
  </remove>
  <remove  cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "AMD64" msiexec %MSI% /x{91140000-0011-0000-1000-0000000FF1CE}'>
    <exit code="3010" />
  </remove>

</package>

<package
  id="office2007plus"
  name="MS Office Pro Plus 2007"
  revision="4"
  reboot="false"
  priority="10">

  <check type="uninstall" condition="exists" path="Microsoft Office Professional Plus 2007" />

  <install cmd='"%SOFTWARE%\MS Office Pro Plus 2007 SP2\setup.exe"'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </install>

  <remove cmd="MsiExec.exe /X{90120000-0011-0000-0000-0000000FF1CE} %MSI%">
    <exit code="3010" />
  </remove>

</package>

<package
  id="office2007std"
  name="MS Office Standard 2007"
  revision="4"
  reboot="false"
  priority="10">

  <check type="uninstall" condition="exists" path="Microsoft Office Standard 2007" />

  <install cmd='"%SOFTWARE%\MS Office Std 2007 SP2\setup.exe"'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </install>

  <remove cmd="MsiExec.exe /X{90120000-0012-0000-0000-0000000FF1CE} %MSI%">
    <exit code="3010" />
  </remove>

</package>

<package
  id="office2000pro"
  name="MS Office 2000 Professional"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <!-- Version number from setup.exe -->
  <variable name="version" value="9.0.0.2611" />

  <check type="uninstall" condition="exists" path="Microsoft Office 2000 Professional" />

  <!-- Use Microsoft Office 2000 Resource Kit Tools to generate a transform -->
  <install cmd='"%SOFTWARE%\Office2000\setup.exe" TRANSFORMS="%SOFTWARE%\Office2000\custom.mst" /wait /qn'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </install>

  <upgrade cmd='"%SOFTWARE%\Office2000\setup.exe" TRANSFORMS="%SOFTWARE\Office2000\custom.mst" /wait /qn'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </upgrade>

  <downgrade cmd='"%SOFTWARE\Office2000\setup.exe" TRANSFORMS="%SOFTWARE\Office2000\custom.mst" /wait /qn'>
    <exit code="1641" reboot="postponed" />
    <exit code="3010" reboot="postponed" />
  </downgrade>

  <remove cmd="MsiExec.exe /X{00010413-78E1-11D2-B60F-006097C998E7} %MSI%">
    <exit code="1641" />
    <exit code="3010" />
  </remove>
</package>

<!--
  NOTES
  1) TODO: some startup job runs - how to remove it?
 -->

<package
  id="uninstall-oe"
  name="Outlook Express Uninstall"
  revision="5"
  execute="once">
  <install cmd='%COMSPEC% /c IF EXIST %windir%\INF\oeaccess.inf RunDll32 advpack.dll,LaunchINFSection %windir%\INF\oeaccess.inf,UninstallOE' />
  <!--
  <install cmd='reg add "HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{89820200-ECBD-11cf-8B85-00AA005B4383}" /t REG_DWORD /v IsInstalled /d 0 /f' />
  <install cmd='reg add "HKLM\SOFTWARE\Microsoft\Active Setup\Installed Components\{44BBA840-CC51-11CF-AAFA-00AA00B6015C}" /t REG_DWORD /v IsInstalled /d 0 /f' />
  -->
  <install cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES%\Outlook Express" RD /Q /S "%PROGRAMFILES%\Outlook Express"' />
</package>

</packages>
