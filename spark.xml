<?xml version="1.0" encoding="UTF-8"?>

<packages>

  <!--
  NOTES
  1) http://www.igniterealtime.org/projects/spark/index.jsp
  2) For some super odd reason, Spark needs to be start once as admin before normal users can start it, so we do that and kill it again on install
  -->

<package
  id="spark"
  name="Spark IM"
  revision="%version%-2"
  reboot="false"
  priority="10">

  <check type="uninstall" condition="versiongreaterorequal" path="Spark" value="2.5.8" />

  <install cmd='taskkill /f /im spark.exe'><exit code="any" /></install>
  <install cmd='msiexec /i "%SOFTWARE%\SparkIM\spark_2_5_8_online.msi" %MSI%' />
  <install cmd='%COMSPEC% /c DEL /Q "%ALLUSERSPROFILE%\Spark*.lnk"' />

  <upgrade cmd='taskkill /f /im spark.exe'><exit code="any" /></upgrade>
  <upgrade cmd='msiexec /i "%SOFTWARE%\SparkIM\spark_2_5_8_online.msi" %MSI%' />
  <upgrade cmd='%COMSPEC% /c DEL /Q "%ALLUSERSPROFILE%\Spark*.lnk"' />

  <downgrade cmd='taskkill /f /im spark.exe'><exit code="any" /></downgrade>
  <downgrade cmd='msiexec /i "%SOFTWARE%\SparkIM\spark_2_5_8_online.msi" %MSI%' />
  <downgrade cmd='%COMSPEC% /c DEL /Q "%ALLUSERSPROFILE%\Spark*.lnk"' />

  <remove  cmd='msiexec /x "%SOFTWARE%\SparkIM\spark_2_5_8_online.msi" %MSI%' />

</package>

</packages>
