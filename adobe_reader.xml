<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) You can also download full installers from ftp://ftp.adobe.com/pub/adobe/reader/win/ - check the misc dir for language packs
  2) TODO: This needs to be tested on 64 bit as the start up registry entries need to be deleted from another path on that platform
  3) Enterprise deployment:
  http://www.adobe.com/devnet/acrobat/enterprise_deployment.html
  4) Protect Mode doesn't work when trying to preview pdf in Word
-->

<packages>

<package
  id="adobereader"
  name="Adobe Reader"
  revision="101"
  priority="10"
  execute="once">

  <depends package-id="adobereaderX" />

</package>

<package
  id="adobereaderX"
  name="Adobe Reader X"
  revision="%version%-4"
  reboot="false"
  priority="10">

  <variable name="version" value="10.1.0" />
  <variable name="language" value="%language%" lcid="0409,0809,4809" />

  <check type="uninstall" condition="exists" path="Adobe Reader X (%version%).*" />

  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdr1010_%language%.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\10\readerX.mst"'>
    <exit code="3010" reboot="false" />
  </install>
  <!--
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdrUpd1001.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="false" />
  </install>
  -->
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\post_install.cmd" "%SOFTWARE%\Adobe\Reader\10\post_install.cmd"' />

  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdr1010_%language%.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\10\readerX.mst"'>
    <exit code="3010" reboot="false" />
  </upgrade>
  <!--
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdrUpd1001.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="false" />
  </upgrade>
  -->
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\post_install.cmd" "%SOFTWARE%\Adobe\Reader\10\post_install.cmd"' />

  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\10\pre_install.cmd"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdr1010_%language%.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\10\readerX.mst"'>
    <exit code="3010" reboot="false" />
  </downgrade>
  <!--
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdrUpd1001.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="false" />
  </downgrade>
  -->
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\10\post_install.cmd" "%SOFTWARE%\Adobe\Reader\10\post_install.cmd"' />

  <remove cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\10.1\AdbeRdr1010_%language%.msi"' />
  <remove cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\post_install.cmd" "%SOFTWARE%\Adobe\Reader\post_install.cmd"' />

</package>

<package
  id="adobereader9"
  name="Adobe Reader 9"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="9.4.6" />
  <variable name="last" value="6" /> <!-- change this when the version increases -->
  <variable name="lt" value='"%WPKG%\tools\localetool.exe"' />
  <variable name="subst" value='%COMSPEC% /C FOR /F "usebackq tokens=1-10"' />

  <check type="uninstall" condition="exists" path="Adobe Reader %version%.*" />

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <install cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></install>
  <install cmd='msiexec %MSI% /x{AC76BA86-7AD7-1033-7B44-AA0000000001}'><exit code="1605" /></install> <!-- remove 10.0 -->
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd"' />
  <install cmd='%subst% %A IN (`%lt% isolang isoctry`) DO msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdr940_%A_%B.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\9\reader9.mst"'>
    <exit code="3010" reboot="false" />
  </install>
  <install cmd='%COMSPEC% /C FOR /L %I IN (1,1,%last%) DO msiexec /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdrUpd94%I_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'><exit code='3010' reboot='false' /></install>
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\post_install.cmd" "%SOFTWARE%\Adobe\Reader\9\post_install.cmd"' />
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </install>
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </install>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <upgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></upgrade>
  <upgrade cmd='msiexec %MSI% /x{AC76BA86-7AD7-1033-7B44-AA0000000001}'><exit code="1605" /></upgrade> <!-- remove 10.0 -->
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd"' />
  <upgrade cmd='%subst% %A IN (`%lt% isolang isoctry`) DO msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdr940_%A_%B.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\9\reader9.mst"'>
    <exit code="3010" reboot="false" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C FOR /L %I IN (1,1,%last%) DO msiexec /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdrUpd94%I_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'><exit code='3010' reboot='false' /></upgrade>
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\post_install.cmd" "%SOFTWARE%\Adobe\Reader\9\post_install.cmd"' />
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </upgrade>
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </upgrade>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <downgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
   <exit code="1605" />
   <exit code="1618" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></downgrade>
  <downgrade cmd='msiexec %MSI% /x{AC76BA86-7AD7-1033-7B44-AA0000000001}'><exit code="1605" /></downgrade> <!-- remove 10.0 -->
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd" "%SOFTWARE%\Adobe\Reader\9\pre_install.cmd"' />
  <downgrade cmd='%subst% %A IN (`%lt% isolang isoctry`) DO msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdr940_%A_%B.msi" TRANSFORMS="%SOFTWARE%\Adobe\Reader\9\reader9.mst"'>
    <exit code="3010" reboot="false" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C FOR /L %I IN (1,1,%last%) DO msiexec /i "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdrUpd94%I_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'><exit code='3010' reboot='false' /></downgrade>
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Reader\9\post_install.cmd" "%SOFTWARE%\Adobe\Reader\9\post_install.cmd"' />
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </downgrade>
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </downgrade>

  <remove cmd='%subst% %A IN (`%lt% isolang isoctry`) DO msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\9.4\AdbeRdr940_%A_%B.msi"' />
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </remove>
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </remove>

</package>

<package
  id="adobewizard"
  name="Adobe Customization Wizard X"
  revision="%version%-4"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <check type="uninstall" condition="exists" path="Adobe Customization Wizard X" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\CustWiz.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\CustWiz.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\CustWiz.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\10\CustWiz.msi"' />
</package>

<package
  id="adobereader_jp"
  name="Acrobat Reader X - Japanese Font Pack"
  revision="%version%-3"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <depends package-id="adobereaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Japanese Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ja_JP.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ja_JP.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ja_JP.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ja_JP.msi"' />
</package>

<package
  id="adobereader_cn"
  name="Acrobat Reader X - Chinese Font Pack"
  revision="%version%-3"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <depends package-id="adobereaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Chinese Simplified Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_zh_CN.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_zh_CN.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_zh_CN.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\10\FontPack1000_zh_CN.msi"' />
</package>

<package
  id="adobereader_kr"
  name="Acrobat Reader X - Korean Font Pack"
  revision="%version%-3"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0" />

  <depends package-id="adobereaderX" />

  <check type="uninstall" condition="versiongreaterorequal" path="Korean Fonts Support For Adobe Reader X" value="%version%" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ko_KR.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ko_KR.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ko_KR.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\10\FontPack1000_ko_KR.msi"' />
</package>

<package
  id="adobereader_jp_9"
  name="Acrobat Reader 9 Japanese"
  revision="%version%-5"
  reboot="false"
  priority="10">

  <variable name="version" value="9.0.0" />

  <depends package-id="adobereader9" />

  <check type="uninstall" condition="versiongreaterorequal" path="Japanese Fonts Support For Adobe Reader 9" value="%version%" />
  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9\FontPack90_ja_JP.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9\FontPack90_ja_JP.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Reader\9\FontPack90_ja_JP.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Reader\9\FontPack90_ja_JP.msi"' />

</package>

</packages>
