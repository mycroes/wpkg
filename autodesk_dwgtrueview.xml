<?xml version="1.0" encoding="UTF-8"?>

<packages>

  <!--
  1) This package depends on DirectX which we currently cannot install automatically
  2) After downloading the .exe packages use 7zip (or just run the exe) to extract the files into x86 and amd64 folders

  Direct download links:
  http://download.autodesk.com/esd/dwgtrueview/2011/SetupDWGTrueView2011_32bit.exe
  http://download.autodesk.com/esd/dwgtrueview/2011/SetupDWGTrueView2011_64bit.exe


SETUP.EXE /w /t /q setup.ini
  -->

<package
  id="autodesk_dwgtrueview"
  name="Autodesk DWG TrueView 2012"
  revision="%version%-3"
  reboot="false"
  priority="10">

  <!-- VCruntime 2008 is bundled -->
  <depends package-id="vcruntime" />

  <!-- MSXML 6 is bundled -->
  <depends package-id="msxml" />

  <!-- Requires .NET 4 -->
  <depends package-id="dotnet4" />

  <variable name="version" value="2012" />
  <variable name="PKG_SOURCE" value="%SOFTWARE%\Autodesk\DWGTrueView\2012\%PROCESSOR_ARCHITECTURE%\%PROCESSOR_ARCHITECTURE%\dwgviewr\dwgviewr.msi" />

  <check type="uninstall" condition="exists" path="DWG TrueView %version%" />

  <install cmd='msiexec /i "%PKG_SOURCE%" %MSI%'>
    <exit code='3010' reboot="false" />
  </install>
  <install cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </install>
  <install cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"' os="windows 7">
    <exit code="any" />
  </install>

  <upgrade cmd='msiexec /i "%PKG_SOURCE%" %MSI%'>
    <exit code='3010' reboot="false" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"' os="windows 7">
    <exit code="any" />
  </upgrade>

  <downgrade cmd='msiexec /fa "%PKG_SOURCE%" %MSI%'>
    <exit code='3010' reboot="false" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"' os="windows 7">
    <exit code="any" />
  </downgrade>

  <remove cmd='msiexec /x "%PKG_SOURCE%" %MSI%'>
    <exit code='3010' />
  </remove>

</package>

<package
  id="autodesk_dwgtrueview"
  name="Autodesk DWG TrueView 2011"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <!-- VCruntime 2008 is bundled -->
  <depends package-id="vcruntime" />

  <!-- MSXML 6 is bundled -->
  <depends package-id="msxml" />

  <!-- Requires .NET 3 -->
  <depends package-id="dotnet3" />

  <variable name="version" value="2011" />

  <check type="uninstall" condition="exists" path="DWG TrueView %version%" />

  <install cmd='msiexec /i  "%SOFTWARE%\Autodesk\DWGTrueView\%version%\%PROCESSOR_ARCHITECTURE%\DWGVIEWR.msi" %MSI%'>
    <exit code='3010' reboot="false" />
  </install>
  <install cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </install>
  <install cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </install>

  <upgrade cmd='msiexec /i  "%SOFTWARE%\Autodesk\DWGTrueView\%version%\%PROCESSOR_ARCHITECTURE%\DWGVIEWR.msi" %MSI%'>
    <exit code='3010' reboot="false" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </upgrade>

  <downgrade cmd='msiexec /fa "%SOFTWARE%\Autodesk\DWGTrueView\%version%\%PROCESSOR_ARCHITECTURE%\DWGVIEWR.msi" %MSI%'>
    <exit code='3010' reboot="false" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c del /Q "%ALLUSERSPROFILE%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c del /Q "%PUBLIC%\Desktop\DWG TrueView*.lnk"'>
    <exit code="any" />
  </downgrade>

  <remove cmd='msiexec /x  "%SOFTWARE%\Autodesk\DWGTrueView\%version%\%PROCESSOR_ARCHITECTURE%\DWGVIEWR.msi" %MSI%'>
    <exit code='3010' />
  </remove>

</package>

</packages>
