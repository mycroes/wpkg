<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) You can also download full installers from ftp://ftp.adobe.com/pub/adobe/reader/win/
  2) This needs to be tested on 64 bit as the start up registry entries need to be deleted from another path on that platform
-->

<packages>

<package
  id="acrobatreader"
  name="Adobe Acrobat Reader 9"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="9.4.0" />

  <check type="uninstall" condition="exists" path="Adobe Reader %version%" />

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <install cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></install>
  <install cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></install>
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </install>
  <!--
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd932_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  <install cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </install>
  -->
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </install>
  <install cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </install>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <upgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
    <exit code="1605" />
    <exit code="1618" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></upgrade>
  <upgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></upgrade>
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <!--
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd932_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  <upgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </upgrade>
  -->
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </upgrade>
  <upgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </upgrade>

  <!-- First uninstall Adobe Reader 8.1.2 -->
  <downgrade cmd='msiexec /x{AC76BA86-7AD7-1033-7B44-A80000000002} /qn ' >
   <exit code="1605" />
   <exit code="1618" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.0" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.1" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 8.2" ' ><exit code="any" /></downgrade>
  <downgrade cmd='%COMSPEC% /C rd /Q /S "%PROGRAMFILES%\Adobe\Reader 9.0" ' ><exit code="any" /></downgrade>
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Acrobat Reader\AcroRead.msi" TRANSFORMS="%SOFTWARE%\Acrobat Reader\reader9.mst"'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <!--
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd932_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd933_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  <downgrade cmd='msiexec %MSI% /p "%SOFTWARE%\Acrobat Reader\AdbeRdrUpd934_all_incr.msp" REINSTALL=ALL REINSTALLMODE=omus'>
    <exit code="3010" reboot="postponed" />
  </downgrade>
  -->
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </downgrade>
  <downgrade cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </downgrade>

  <remove cmd='msiexec %MSI% /x "%SOFTWARE%\Acrobat Reader\AcroRead.msi"' />
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe Reader Speed Launcher" /f'>
    <exit code="1" />
  </remove>
  <remove cmd='REG DELETE "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v "Adobe ARM" /f'>
    <exit code="1" />
  </remove>

</package>

<package
  id="adobewizard"
  name="Adobe Customization Wizard 9"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="9.0.0" />

  <check type="uninstall" condition="exists" path="Adobe Customization Wizard 9" />

  <install   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\CustWiz.msi"' />
  <upgrade   cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\CustWiz.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\CustWiz.msi"' />
  <remove    cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\CustWiz.msi"' />
</package>

</packages>
