<?xml version="1.0" encoding="UTF-8"?>

<packages>

<!--
  NOTES
  1) Unfortunately there's a progress dialog for the printer drivers.
  2) See http://www.biopdf.com/guide/setup_command_line_switches.php for
     information (yes, these apply to Bullzip PDF Printer, except for
     PRINTERNAME).
  3) 64bit needs verification for install location (I'm assuming only the
     driver is 64bit).
-->

<package
  id="bullzip_pdfprinter"
  name="Bullzip PDF Printer"
  revision="%version%-2"
  reboot="false">

  <depends package-id="ghostscript" />
  <!-- requires .NET 2.0 -->
  <depends package-id="dotnet3" />

  <variable name="version" value="7.1.0.1218" />
  <variable name="fileversion" value="7_1_0_1218" />
  <variable name="setupopts" value='/VERYSILENT /SP- /SUPPRESSMSGBOXES /NORESTART /NOCANCEL /NOICONS /PRESERVEDEFAULTPRINTER /PRESERVEADVANCEDSETTINGS /GSLITEDOWNLOADMODE=never /RESTARTEXITCODE=3010 /LOG="%TEMP%\bullzip.log"' />

  <check type="uninstall" condition="exists" path="Bullzip PDF Printer %version%" />

  <install cmd='"%SOFTWARE%\Bullzip\BullzipPDFPrinter_%fileversion%.exe" %setupopts%'>
    <exit code='3010' reboot="postponed" />
  </install>

  <upgrade cmd='"%SOFTWARE%\Bullzip\BullzipPDFPrinter_%fileversion%.exe" %setupopts%'>
    <exit code='3010' reboot="postponed" />
  </upgrade>

  <downgrade cmd='"%SOFTWARE%\Bullzip\BullzipPDFPrinter_%fileversion%.exe" %setupopts%'>
    <exit code='3010' reboot="postponed" />
  </downgrade>

  <remove cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "x86" "%PROGRAMFILES%\Bullzip\PDF Printer\unins000.exe" /VERYSILENT /SUPPRESSMSGBOXES /NORESTART' />
  <remove cmd='%COMSPEC% /C IF "%PROCESSOR_ARCHITECTURE%" == "amd64" "%PROGRAMFILES(x86)%\Bullzip\PDF Printer\unins000.exe" /VERYSILENT /SUPPRESSMSGBOXES /NORESTART' />

</package>

</packages>
