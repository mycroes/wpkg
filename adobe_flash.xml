<?xml version="1.0" encoding="UTF-8"?>

<packages>

<package
  id="flash"
  name="Adobe Flash Player"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="10.2.159.1" />

  <!--
  <download url='http://www.adobe.com/go/full_flashplayer_win_msi'
    target='%SOFTWARE%'\Adobe\Flash\10.2\install_flash_player_10_active_x.msi' />
  <download url='http://www.adobe.com/go/full_flashplayer_win_pl_msi'
    target='%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_plugin.msi' />
  -->

  <check type="logical" condition="and">
    <check type="uninstall" condition="versiongreaterorequal" path="Adobe Flash Player 10 ActiveX" value="%version%" />
    <check type="uninstall" condition="versiongreaterorequal" path="Adobe Flash Player 10 Plugin" value="%version%" />
  </check>

  <!--
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\10.1\uninstall_flash_player.exe" "%SOFTWARE%\Adobe\Flash\10.1\uninstall_flash_player.exe"' />
  -->
  <install cmd='taskkill /f /im iexplore.exe'>
    <exit code="any" />
  </install>
  <install cmd='taskkill /f /im firefox.exe'>
    <exit code="any" />
  </install>
  <install cmd='%COMSPEC% /c IF NOT EXIST "%WINDIR%\system32\Macromed\Flash" mkdir "%WINDIR%\system32\Macromed\Flash"' />
  <install cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\mms.cfg" copy /y /v "%SOFTWARE%\Adobe\Flash\mms.cfg" "%WINDIR%\system32\Macromed\Flash\"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_active_x.msi"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_plugin.msi"' />

  <!--
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\10.1\uninstall_flash_player.exe" "%SOFTWARE%\Adobe\Flash\10.1\uninstall_flash_player.exe"' />
  -->
  <upgrade cmd='taskkill /f /im iexplore.exe'>
    <exit code="any" />
  </upgrade>
  <upgrade cmd='taskkill /f /im firefox.exe'>
    <exit code="any" />
  </upgrade>
  <upgrade cmd='%COMSPEC% /c IF NOT EXIST "%WINDIR%\system32\Macromed\Flash" mkdir "%WINDIR%\system32\Macromed\Flash"' />
  <upgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\mms.cfg" copy /y /v "%SOFTWARE%\Adobe\Flash\mms.cfg" "%WINDIR%\system32\Macromed\Flash\"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_active_x.msi"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_plugin.msi"' />

  <downgrade cmd='taskkill /f /im iexplore.exe'>
    <exit code="any" />
  </downgrade>
  <downgrade cmd='taskkill /f /im firefox.exe'>
    <exit code="any" />
  </downgrade>
  <downgrade cmd='%COMSPEC% /c IF NOT EXIST "%WINDIR%\system32\Macromed\Flash" mkdir "%WINDIR%\system32\Macromed\Flash"' />
  <downgrade cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\mms.cfg" copy /y /v "%SOFTWARE%\Adobe\Flash\mms.cfg" "%WINDIR%\system32\Macromed\Flash\"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_active_x.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_plugin.msi"' />

  <remove cmd='taskkill /f /im iexplore.exe'>
    <exit code="any" />
  </remove>
  <remove cmd='taskkill /f /im firefox.exe'>
    <exit code="any" />
  </remove>
  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_active_x.msi"' />
  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Adobe\Flash\10.2\install_flash_player_10_plugin.msi"' />
  <remove cmd='%COMSPEC% /c del /s /q "%WINDIR%\system32\Macromed\Flash\mms.cfg"' >
    <exit code="0" />
    <exit code="1" />
  </remove>
  <!--
  <remove  cmd='%COMSPEC% /c IF EXIST "%SOFTWARE%\Adobe\Flash\10.2\uninstall_flash_player.exe" "%SOFTWARE%\Adobe\Flash\10.2\uninstall_flash_player.exe"' />
  -->
</package>

</packages>
