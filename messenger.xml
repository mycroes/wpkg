<?xml version="1.0" encoding="UTF-8"?>

<!--
  NOTES
  1) See below for full instructions
-->

<packages>

<package
  id="livemessenger"
  name="Windows Live Messenger"
  revision="%version%-0"
  reboot="false"
  priority="10">

  <variable name="version" value="14.0.8117.0416" />
  <check type="uninstall" condition="versiongreaterorequal" path="Windows Live Messenger" value="%version%" />

  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\SegoeFont.msi"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\crt.msi"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Contacts.msi"' />
  <install cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Messenger.msi"'><exit code="3010" /></install>

  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\SegoeFont.msi"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\crt.msi"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Contacts.msi"' />
  <upgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Messenger.msi"'><exit code="3010" /></upgrade>

  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\SegoeFont.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\crt.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Contacts.msi"' />
  <downgrade cmd='msiexec %MSI% /i "%SOFTWARE%\Windows Live\Messenger.msi"'><exit code="3010" /></downgrade>

  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Windows Live\SegoeFont.msi"' />
  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Windows Live\crt.msi"' />
  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Windows Live\Contacts.msi"' />
  <remove  cmd='msiexec %MSI% /x "%SOFTWARE%\Windows Live\Messenger.msi"'><exit code="3010" /></remove>

</package>

<!--
  NOTES
  1) Registry needs to be updated for the user running it, so add the following to the logon script instead: regedit /s "%PROGRAMFILES%\Yahoo!\Messenger\default.reg" and "intl.reg"

 -->

<package
  id="yahoomessenger"
  name="Yahoo Messenger"
  revision="%version%-1"
  reboot="false"
  priority="10">

  <variable name="version" value="10.0.0.1270" />

  <check type="logical" condition="or">
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES%\Yahoo!\Messenger\YahooMessenger.exe" value="%version%" />
    <check type="file" condition="versiongreaterorequal" path="%PROGRAMFILES(x86)%\Yahoo!\Messenger\YahooMessenger.exe" value="%version%" />
  </check>
  <install   cmd='"%SOFTWARE%\Yahoo\ymsgr_inst.exe" /s /q' />
  <upgrade   cmd='"%SOFTWARE%\Yahoo\ymsgr_inst.exe" /s /q' />
  <downgrade cmd='"%SOFTWARE%\Yahoo\ymsgr_inst.exe" /s /q' />
  <remove    cmd='taskkill /f /im YahooMessenger.exe'><exit code="any" /></remove>
  <remove    cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES%\Yahoo!\Messenger\UNWISE.exe" "%PROGRAMFILES%\Yahoo!\Messenger\UNWISE.exe" /S /U "%PROGRAMFILES%\Yahoo!\Messenger\INSTALL.log"' />
  <remove    cmd='%COMSPEC% /c IF EXIST "%PROGRAMFILES(x86)%\Yahoo!\Messenger\UNWISE.exe" "%PROGRAMFILES(x86)%\Yahoo!\Messenger\UNWISE.exe" /S /U "%PROGRAMFILES(x86)%\Yahoo!\Messenger\INSTALL.log"' />
</package>

<package
  id="uninstall-msmsgs"
  name="Windows Messenger Uninstall"
  revision="2"
  execute="once">
  <install cmd='%COMSPEC% /c IF EXIST %windir%\INF\msmsgs.inf RunDll32 advpack.dll,LaunchINFSection %windir%\INF\msmsgs.inf,BLC.Remove' />
</package>

</packages>

<!--
  HOW TO OBTAIN THE FILES
  1) Download Windows Live Installer from download.live.com.
  2) Install or upgrade the Windows Live Messenger to latest version.
  3) Browse to \Program Files\Common Files\Windows Live\.cache\ folder.
  4) Locate the following files in the subfolders and copy them out:
   a) crt.msi
   b) contacts.msi
   c) segoefont.msi
   d) messenger.msi
   e) dw20shared.msi (I couldn't find this and it seems to work without)
-->